\begin{Verbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{langchain.schema.runnable} \PYG{k+kn}{import} \PYG{n}{RunnableMap}

\PYG{n}{input\PYGZus{}data} \PYG{o}{=} \PYG{n}{RunnableMap}\PYG{p}{(\PYGZob{}}
        \PYG{l+s+s1}{\PYGZsq{}context\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{retriever\PYGZus{}instance}\PYG{o}{.}\PYG{n}{get\PYGZus{}relevant\PYGZus{}documents}\PYG{p}{(}\PYG{n}{x}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}question\PYGZsq{}}\PYG{p}{]),}
        \PYG{l+s+s1}{\PYGZsq{}question\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}question\PYGZsq{}}\PYG{p}{]}
    \PYG{p}{\PYGZcb{})}
\PYG{n}{response\PYGZus{}chain} \PYG{o}{=} \PYG{n}{input\PYGZus{}data} \PYG{o}{|} \PYG{n}{chat\PYGZus{}prompt} \PYG{o}{|} \PYG{n}{chat\PYGZus{}model\PYGZus{}instance}
\end{Verbatim}
